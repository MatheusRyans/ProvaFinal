<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Principal - SAEP Estoque</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header>
        <h1>SAEP | Gest√£o de Almoxarifado</h1>
        <div>
            Bem-vindo(a), <span id="userName">Carregando...</span>!
            <button class="logout-btn" onclick="logout()">Sair</button>
        </div>
    </header>

    <div class="container">
        <h2>Painel Principal</h2>
        <p>Selecione uma das op√ß√µes abaixo para iniciar a gest√£o do estoque:</p>
        
        <div style="display: flex; gap: 20px; margin-top: 30px;">
            <a href="/views/cadastro_produto.html" style="text-decoration: none; flex: 1;">
                <button style="width: 100%; background-color: #007bff;">
                    ‚ûï Cadastro de Produto
                </button>
            </a>
            
            <a href="/views/gestao_estoque.html" style="text-decoration: none; flex: 1;">
                <button style="width: 100%; background-color: #ffc107; color: #333;">
                    üìä Gest√£o de Estoque & Movimenta√ß√£o
                </button>
            </a>
        </div>
    </div>

    <script>
        // Fun√ß√£o para carregar o nome do usu√°rio (RF5.1.1)
        async function loadUserName() {
            try {
                const response = await fetch('/api/auth/user');
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('userName').textContent = data.name;
                } else {
                    // Caso a sess√£o expire, redireciona
                    window.location.href = '/views/login.html';
                }
            } catch (error) {
                console.error('Erro ao buscar nome do usu√°rio:', error);
                window.location.href = '/views/login.html';
            }
        }

        // Fun√ß√£o de Logout (RF5.1.2)
        async function logout() {
            try {
                await fetch('/api/auth/logout', { method: 'POST' });
                window.location.href = '/views/login.html';
            } catch (error) {
                console.error('Erro ao realizar logout:', error);
            }
        }
        
        loadUserName();
    </script>
</body>
</html>